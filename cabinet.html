<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
  <link rel="stylesheet" href="styles.css" />

  <style>
    button, .btn-main, .btn-secondary{
      transition: transform .08s ease, filter .12s ease, box-shadow .12s ease, opacity .12s ease;
      -webkit-tap-highlight-color: transparent;
    }
    button:active, .btn-main:active, .btn-secondary:active{
      transform: translateY(1px) scale(.99);
      filter: brightness(.98);
    }

    #tab10, #tab50, #tab100{ opacity:.95 }
    .tab-active{ opacity:1!important }

    /* ===== –ë–õ–û–ö –Ø–†–õ–´–ö–ê (–¢–û–õ–¨–ö–û –°–¢–†–û–ö–ê) ===== */
    .shortcutLine{
      margin-top:12px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.05);
      font-size:15px;
      line-height:1.5;
      opacity:.92;
    }

    /* ===== –ö–ù–û–ü–ö–ò –î–ï–ô–°–¢–í–ò–ô ===== */
    .actions{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top:14px;
      align-items:flex-start;
    }
    .actionItem{ width:100% }

    .actions .btn-main{
      width:260px;
      max-width:90%;
    }

    .actionHint{
      font-size:14px;
      line-height:1.35;
      opacity:.82;
      margin:6px 0 0 10px;
    }

    .soft-disabled{
      opacity:.72!important;
      filter:saturate(.95) brightness(.92);
    }

    .with-lock{
      position:relative;
      padding-left:44px!important;
    }
    .with-lock::before{
      content:"üîí";
      position:absolute;
      left:16px;
      top:50%;
      transform:translateY(-50%);
      font-size:18px;
      opacity:.9;
    }

    .treeTitle{
      font-weight:900;
      font-size:20px;
      margin:18px 0 10px;
      white-space:nowrap;
    }

    /* ‚Üì –£–ú–ï–ù–¨–®–ï–ù–ù–ê–Ø –ö–ù–û–ü–ö–ê –û–ß–ï–†–ï–î–ò (–ù–ï –ë–û–ß–û–ù–û–ö) */
    #btnGoQueue{
      width:220px;
      max-width:85%;
      font-size:14px;
      padding:10px 14px;
    }
  </style>
</head>

<body>
<div class="wrap">
<div class="card">
<h1 style="margin-top:0;">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>

<div class="note" id="whoNote"></div>

<div class="shortcutLine">
üìå –Ø—Ä–ª—ã–∫ –Ω–∞ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª: –º–µ–Ω—é –±—Ä–∞—É–∑–µ—Ä–∞ (‚ãÆ) ‚Üí ¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω¬ª.
</div>

<div style="display:flex; gap:10px; margin:16px 0;">
  <button class="btn-secondary" id="tab10">10 ‚Ç¥</button>
  <button class="btn-secondary" id="tab50">50 ‚Ç¥</button>
  <button class="btn-secondary" id="tab100">100 ‚Ç¥</button>
</div>

<div class="note" id="lineTitle"></div>
<div class="note" id="statusBox"></div>

<div class="actions" id="actionsBox">
  <div class="actionItem">
    <button class="btn-main" id="btnTake3" disabled>–ó–∞–Ω—è—Ç—å 3-–µ –º–µ—Å—Ç–æ</button>
    <div class="actionHint" id="hintTake3"></div>
  </div>
  <div class="actionItem">
    <button class="btn-main" id="btnConfirm" disabled>–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–º–æ—â—å</button>
    <div class="actionHint" id="hintConfirm"></div>
  </div>
  <div class="actionItem">
    <button class="btn-main" id="btnReject" disabled>–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
    <div class="actionHint" id="hintReject"></div>
  </div>
</div>

<div id="joinBox" style="display:none;margin-top:16px;">
  <button class="btn-main" id="btnGoQueue">
    –ü–µ—Ä–µ–π—Ç–∏ –≤ ¬´–û—á–µ—Ä–µ–¥—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤¬ª
  </button>
</div>

<hr style="margin:18px 0;opacity:.25">

<div>
  <div class="treeTitle">–í–∞—à–∏ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã–µ</div>
  <div class="note" id="treeBox"></div>
</div>

<hr style="margin:18px 0;opacity:.25">

<div class="actions">
  <button class="btn-secondary" id="btnPromo">–†–µ–∫–ª–∞–º–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
  <button class="btn-secondary" id="btnBackQueue">–û—á–µ—Ä–µ–¥—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</button>
</div>

<div class="note" id="msg"></div>
</div>
</div>

<script>
const qs=s=>document.querySelector(s);
const LINES=[10,50,100];
const KEY_ACTIVE_LINE="active_line";
const KEY_MY_ID="my_id";
const KEY_STATE="cabinet_state";

function readState(){
  try{return JSON.parse(localStorage.getItem(KEY_STATE)||"{}")}catch{return{}}
}
function writeState(s){localStorage.setItem(KEY_STATE,JSON.stringify(s))}

function ensureDefaults(){
  const s=readState(); if(!s.lines)s.lines={}
  LINES.forEach(l=>{
    if(!s.lines[l])s.lines[l]={status:"none",tree:{level1:[],level2:[]}}
  })
  writeState(s)
}

function renderTree(t){
  const l1=t.level1.length,l2=t.level2.length
  return `
<b>–£—Ä–æ–≤–µ–Ω—å 1:</b> ${l1} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ ‚Äî –í—ã —É –Ω–∏—Ö –Ω–∞ 2 –º–µ—Å—Ç–µ<br><br>
<b>–£—Ä–æ–≤–µ–Ω—å 2:</b> ${l2} —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ ‚Äî –í—ã —É –Ω–∏—Ö –Ω–∞ 1 –º–µ—Å—Ç–µ<br><br>
<b>–£—Ä–æ–≤–µ–Ω—å 3:</b> - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–º–æ—â—å –í–∞–º
`
}

function render(line){
  const s=readState().lines[line]
  qs("#treeBox").innerHTML=renderTree(s.tree)
}

(function init(){
  ensureDefaults()
  const my=localStorage.getItem(KEY_MY_ID)||"TEST123"
  localStorage.setItem(KEY_MY_ID,my)
  qs("#whoNote").innerHTML=`–í–∞—à ID: <b>${my}</b>`
  render(50)
})();
</script>
</body>
</html>

