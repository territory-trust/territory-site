<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</title>
  <link rel="stylesheet" href="styles.css" />

  <style>
    button{
      transition: transform .08s ease, filter .12s ease, box-shadow .12s ease;
      -webkit-tap-highlight-color: transparent;
    }
    button:active{
      transform: translateY(1px) scale(.99);
      filter: brightness(.98);
    }
    .tab-active{ opacity:1 !important; }
  </style>
</head>

<body>
<div class="wrap">
<div class="card">

<h1 style="margin-top:0;">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h1>

<div class="note" id="whoNote"></div>

<!-- –ª–∏–Ω–∏–∏ -->
<div style="display:flex; gap:10px; margin:16px 0;">
  <button class="btn-secondary" id="tab10">10 ‚Ç¥</button>
  <button class="btn-secondary" id="tab50">50 ‚Ç¥</button>
  <button class="btn-secondary" id="tab100">100 ‚Ç¥</button>
</div>

<div class="note" id="lineTitle" style="font-weight:700;"></div>
<div class="note" id="statusBox" style="line-height:1.6;"></div>

<!-- –∫–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
<div id="actions" style="display:none; flex-direction:column; gap:10px; margin-top:14px;">
  <button class="btn-main" id="btnTake3" disabled>üîí –ó–∞–Ω—è—Ç—å 3-–µ –º–µ—Å—Ç–æ</button>
  <button class="btn-main" id="btnConfirm" disabled>üîí –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–º–æ—â—å</button>
  <button class="btn-secondary" id="btnReject" disabled>üîí –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
</div>

<!-- –æ—á–µ—Ä–µ–¥—å -->
<div id="joinBox" style="display:none; margin-top:16px;">
  <button class="btn-main" id="btnGoQueue">
    –ü–µ—Ä–µ–π—Ç–∏ –≤ ¬´–û—á–µ—Ä–µ–¥—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤¬ª
  </button>
</div>

<hr style="margin:18px 0; opacity:.25;" />

<div class="note" style="font-size:22px; font-weight:800;">
  –î–µ—Ä–µ–≤–æ –ø—Ä–∏–≥–ª–∞—à—ë–Ω–Ω—ã—Ö
</div>

<div class="note" id="treeBox" style="line-height:1.6;"></div>

<hr style="margin:18px 0; opacity:.25;" />

<div style="display:flex; gap:10px; flex-wrap:wrap;">
  <button class="btn-secondary" id="btnPromo">–†–µ–∫–ª–∞–º–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
  <button class="btn-secondary" id="btnBackQueue">–û—á–µ—Ä–µ–¥—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</button>
</div>

</div>
</div>

<script>
const qs = s => document.querySelector(s);
const LINES = [10,50,100];
const KEY_STATE = "cabinet_state";
const KEY_ACTIVE = "active_line";

function state(){
  return JSON.parse(localStorage.getItem(KEY_STATE)||'{"lines":{}}');
}
function save(s){ localStorage.setItem(KEY_STATE, JSON.stringify(s)); }

function render(line){
  const s = state();
  if(!s.lines[line]) s.lines[line]={status:"none",tree:{level1:[],level2:[]}};

  const status = s.lines[line].status;
  localStorage.setItem(KEY_ACTIVE,line);

  qs("#lineTitle").textContent = `–õ–∏–Ω–∏—è: ${line} ‚Ç¥`;

  qs("#actions").style.display = "none";
  qs("#joinBox").style.display = "none";

  if(status==="none"){
    qs("#statusBox").innerHTML =
      `<b>–°—Ç–∞—Ç—É—Å:</b> –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç–µ<br>
       –ß—Ç–æ–±—ã —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —ç—Ç–æ–π –ª–∏–Ω–∏–∏ ‚Äî –ø—Ä–æ–π–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—É —á–µ—Ä–µ–∑ ¬´–û—á–µ—Ä–µ–¥—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤¬ª.`;
    qs("#joinBox").style.display="block";
  }

  if(status==="candidate_waiting"){
    qs("#statusBox").innerHTML =
      `<div style="padding:14px;border-radius:14px;border:1px solid rgba(255,210,90,.55);text-align:center">
        <div style="font-size:22px;font-weight:900;">üïí –û–ñ–ò–î–ê–ï–ú –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø</div>
        –í—ã ‚Äî <b>–∫–∞–Ω–¥–∏–¥–∞—Ç</b>. –ñ–¥—ë–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è ‚Ññ1.
      </div>`;
    qs("#actions").style.display="flex";
    qs("#btnConfirm").disabled=false;
    qs("#btnReject").disabled=false;
  }

  if(status==="confirmed_can_take3"){
    qs("#statusBox").innerHTML =
      `<div style="padding:14px;border-radius:14px;border:1px solid rgba(120,220,140,.55);text-align:center">
        <div style="font-size:22px;font-weight:900;">‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–û</div>
        –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∑–∞–Ω—è—Ç—å 3-–µ –º–µ—Å—Ç–æ.
      </div>`;
    qs("#actions").style.display="flex";
    qs("#btnTake3").disabled=false;
  }

  if(status==="member"){
    qs("#statusBox").innerHTML = `<b>–°—Ç–∞—Ç—É—Å:</b> —É—á–∞—Å—Ç–Ω–∏–∫`;
  }

  qs("#treeBox").innerHTML =
    `<b>–£—Ä–æ–≤–µ–Ω—å 1:</b><br>‚Äî –ø–æ–∫–∞ –ø—É—Å—Ç–æ ‚Äî<br><br>
     <b>–£—Ä–æ–≤–µ–Ω—å 2:</b><br>‚Äî –ø–æ–∫–∞ –ø—É—Å—Ç–æ ‚Äî`;
}

(function(){
  const s = state();
  if(!s.lines) s.lines={};
  save(s);

  const line = Number(localStorage.getItem(KEY_ACTIVE)||50);
  render(line);

  qs("#tab10").onclick=()=>render(10);
  qs("#tab50").onclick=()=>render(50);
  qs("#tab100").onclick=()=>render(100);

  qs("#btnGoQueue").onclick=()=>location.href="queue.html";
})();
</script>
</body>
</html>

